#
# manual edits will be lost
# use svn://svn.debian.org/svn/debconf-video/fai-config/files/home/dvswitch/.Xsession/$hostname
#

setxkbmap -option terminate:ctrl_alt_bksp &

# disable screensaver
xset -dpms

# kill old sinks in case there are some left
xterm -e ssh todd 'ps fax | grep "bash -c dvsink-command -h scratchy -p 4321 -- ffmpeg2theora"|grep -v grep | sed -e "s/^ *//" | cut -d " " -f1  | xargs -n 1 kill -9' 
xterm -e ssh blinky 'ps fax | grep "dvgrab -noavc -"|grep -v grep | sed -e "s/^ *//" |cut -d " " -f1  | xargs -n 1 kill -9' 
xterm -e ssh itchy 'ps fax | grep "dvgrab -noavc -"|grep -v grep | sed -e "s/^ *//" |cut -d " " -f1  | xargs -n 1 kill -9' 

# setup dvswitch
xterm -e dvswitch &
sleep 1
xterm -e "dc-start-source firewire+tally:scratchy" &
sleep 3
xterm -e "dc-start-source firewire+tally:itchy" &
sleep 3
xterm -e "dc-start-source firewire:blinky" &
sleep 3
dvsource-file -l /home/dvswitch/dc11simple.dv &
xterm -e "dc-start-sink file:scratchy" &
xterm -e "while true ; do dc-start-sink icecast:todd ; done" &

# last command
xfce4-session
